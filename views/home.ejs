
<!doctype html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Traveling Table | Home</title>

<link rel="shortcut icon" href="/graphics/favicon.ico" type="image/x-icon">
<link rel="icon" href="/graphics/favicon.ico" type="image/x-icon">


<meta name="viewport" content="width=device-width, initial-scale=1">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,600,400' rel='stylesheet' type='text/css'>
<script src="https://maps.google.com/maps/api/js?sensor=true"></script>
<!--<script src="https://maps.googleapis.com/maps/api/js"></script>-->
<script src="https://code.jquery.com/jquery-latest.min.js"></script>
<script src ="https://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/src/markerclusterer.js"></script>


<script type="text/javascript">
  $("#signupmessage").hide();
  //$("#features").hide();
  //console.log("hiding features tab");
</script>


<!-- onload script-->
<script type="text/javascript">


function buttondisplay() {
    $.ajax({
        type: "POST",
        url: "/Refresh",
        success: function(data) {
          //console.log('LOGGED in var below')
          //console.log(data.authenticated);
           if (data.authenticated) {
             $("#log_out").show();
             $("#log_in").hide();
             $("#add_recipe").show();
             $("#sign_up").hide();
             $("#profile").show();
             $(".upvotebutton").show();
             $(".voted").hide();
           } else {
             $("#log_out").hide();
             $("#log_in").show();
             $("#add_recipe").hide();
             $("#sign_up").show();
             $("#profile").hide;
             $(".upvotebutton").hide();
             $(".voted").hide();
           }
}
});
};
</script>

              


<!--<script src="/javascripts/marker_loading.js"></script>-->
<script src="/javascripts/home_map_scripts.js"></script>



<!--LOGIN FORM-->

<!--END LOGIN-->
<!--for sliders-->
<!--script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js" type="text/javascript"></script>
<script src="http://tab-slide-out.googlecode.com/files/jquery.tabSlideOut.v1.3.js"></script-->

<link rel="stylesheet" href="/stylesheets/animate.min.css">
<script src="/javascripts/validation.js"></script>
<script src="/javascripts/bootstrap.min.js"></script>
<link href="/stylesheets/bootstrap.min.css" rel="stylesheet">
<script src="/javascripts/recipe.js"></script>
<link rel="stylesheet" type="text/css" href="/stylesheets/main.css"/>
</head>



<body onload="buttondisplay()">







<!--===========================================================================-->
<!--                       n e w    s e a r c h    i n p u t   t a b    
<!-============================================================================-->
<div class="other">
<a href="#" ><img src="graphics/GlobalGobi.png" class="brand2"></a>


 <form id="search" role="search">
            <div class="input-group">
               <input type="text" autocomplete="off" id="search_input" name="search_input" class="form-control search" placeholder="Search for a recipe...">
               <div class="input-group-btn">
                  <button id="search_button" type="submit" class="search2 btn btn-default round"><span class="glyphicon glyphicon-search"></span></button>
               </div>
            </div>
         </form>
</div>






<div class="navbar navbar-inverse navbar-default navbar-fixed-top">
   <div class="container">
      <div class="navbar-header">
         <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
         </button>

        <!-- <a class="navbar-brand hidden-xs" href="#" style="vertical-align:center"><img src="graphics/GlobalGobi.png" class="brand" style="max-width:40px;height:auto"></a>
         <a class="navbar-brand visible-xs" href="#" style="vertical-align:center"><img src="graphics/GlobalGobi.png" class="brand" style="max-width:40px;height:auto"></a>-->
         


</div>

<!--================================================================================-->
<!--                              s e a r c h
<!================================================================================-->
   <div class="navbar-collapse collapse"> 


    <!--ul class="nav navbar-nav navbar-left">
       <li>
         <form class="navbar-form" role="search">
            <div class="input-group">
               <input type="text" autocomplete="off" id="search_input" name="search_input" class="form-control search" placeholder="Search for a recipe...">
               <div class="input-group-btn">
                  <button id="search_button" type="submit" class="search2 btn btn-default round"><span class="glyphicon glyphicon-search"></span></button>
               </div>
            </div>
         </form>
      
  </li>
</ul-->




      
         <ul class="nav navbar-nav navbar-right">
 
        

<!--================================================================================-->
<!--                                       h e l p 
<!================================================================================-->


<li><a href="#">Help</a></li>



<!--================================================================================-->
<!--                                    f e a t u r e s 
<!================================================================================-->


<li class="dropdown">
            <a href="#" id="myBtn" data-toggle="dropdown" class="dropdown-toggle">Features<b class="caret"></b></a>
            <ul id="drop" class="dropdown-menu" hidden>
                <li><a href="/heatmap" id="gray">Heatmap</a></li>
                <li><a id="feeling_lucky" href="/#" onClick="lucky_click()" >I'm feeling lucky</a></li>
                <li><a href="/GobiPhilosophy" id="gray">the Gobi philosophy</a></li>
                <li><a href="/GobiPhilosophy">our story</a></li>
            </ul>
        </li>

 <script>


$(function() {
$("#myBtn").click(function(){
    if ( $("#drop").hasClass("hidden")) {
         $("#drop").removeClass("hidden");
         $("#drop").slideDown("slow");              
    } else {
       if ( $("#drop").is(":hidden")) {
           $("#drop").slideDown("slow");
       } else {
          $("#drop").slideUp("slow");
        }
  }
})
})

</script>
<script>

$(document).click(function(evt){    
       if(evt.target.id !== "drop") {
          if ($("#drop").hasClass("hidden")===false) {
            $("#drop").slideUp("slow");
            return;
          }
       }
        });  

</script>

<!--==============================================================================-->
<!--                                s i g n   u p 
<!================================================================================-->
             
    <li><a href="#" data-toggle="modal"   class="special" id="sign_up" data-target="#registerModal">Sign-up</a>

<form onSubmit="signupvalidate(event);"><div class="modal fade" id="registerModal" tabindex="-1" role="dialog" aria-labelledby="registerModal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
            <h2 class="modal-title" id="myModalLabel">Create an Account</h2>
            </div>
            

            <div class="modal-body" id="signup_form">
                  <div id="welcome_thing">Welcome to our site! </div><br>
                    <label for="new_username">Don't have a username? Choose one!</label></br>
                    <input type="text" name="new_username" id="username" placeholder="username">
                    <div id="signupfail" class="fail"></div>
                    <label class="error fail" for="new_username" id="new_username_error"> This field is required!</label>
                    <label class="error fail" for="new_username" id="new_username_error2"> Your username can only contain numbers and letters!</label></br>
                    


                    <label for="new_password">Choose a password:</label></br>
                    <input type="password" name="new_password" id="username" placeholder="password"></br>
                     <label class="error fail" for="new_password" id="new_password_error"> This field is required! Passwords cannot contain these characters: ${}&lt;&gt;</label>
                     <label class="error fail" for="new_password" id="new_password_error2"> Your password can only contain numbers and letters!</label><br>

 

                 <label for="new_password">Confirm password:</label></br>
                    <input type="password" name="confirmpassword" id="username" placeholder="password"></br>
                     <label class="error fail" for="confirmpassword" id="confirmpassword_error">Your passwords don't match! Try again!</label>
                     <label class="error fail" for="new_password" id="confirmpassword_error2"> Confirm your password!</label>




                  <input type="submit" name="submit" class="signupbutton button2 btn-large" id="submit_btn" value="Sign Up!" />

          </div>

          <div id='signupmessage1' class="hidden" style="color:black;text-align:center"></br><h3>Registration form submitted!</h3><br><br></div>


    </div>
  </div>
</div></form>
<iframe id="uploader_iframe" name="uploader_iframe" style="display: none;"></iframe><!--register bootstrap--></li>
 
 

<!--================================================================================-->         
<!--                                 l o g i n  
<!================================================================================-->

    <li><a href="#" data-toggle="modal" class="special" id="log_in" data-target="#loginModal">Login</a>
<form onSubmit="loginvalidate(event);"><div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="loginModal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
              <button type="button" id = "close_modal" class="close" data-dismiss="modal" aria-hidden="true">X</button>
              <h2 class="modal-title" id="myModalLabel">Login</h2>
            </div>

      <div class="modal-body" id="login_form">
<!--        <form method="post" name="login" action="">
            <fieldset> -->
             <div id="welcome_thing">  Welcome! <br> Don't have an account? <a href="#" onclick="linkToSignUp()">Sign-up</a> instead!</div><br>
            <label for="username"> Username: </label></br>
              <input type="text" name="username" id="username" placeholder="username"  /></br>
              <label class="error fail" for="username" id="username_error"> This field is required!</label>
              <label class="error fail" for="username" id="username_error2"> Usernames can only contain numbers and letters!</label></br>
              
            <label for="password">Password: </label></br>
              <input type="password" name="password" id="username" placeholder="password"  /></br>
              <label class="error fail" for="password" id="password_error"> This field is required! Passwords cannot contain these characters: ${}&lt;&gt;</label>            


              <input type="submit" name="submit" class="button button2" id="submit_btn" value="Login!" /><br>
              <div id="loginfail" class="fail"></div>
<!--        </fieldset>
      </form>-->
      </div>

      <div id='loginmessage' class="hidden" style="color:black;text-align:center"><h3>Login Form Submitted!</h3><br><br></div>
    </div>
  </div>
</div></form><iframe id="uploader_iframe" name="uploader_iframe" style="display: none;"></iframe><!--login bootstrap--></li>
            
      


<!--================================================================================-->
<!--                            r e c i p e   f o r m 
<!================================================================================-->


<li><a href='/new_recipe' id="add_recipe">Add Recipe</a></li>



<!--================================================================================-->
<!--                            u s e r    p r o f i l e 
<!================================================================================-->


<li><a href='/Profile' id="profile">Profile</a></li>



<!--================================================================================-->
<!--                                    l o g o u t
<!================================================================================-->

<li><a href='#' class="logoutbutton2" id="log_out">Logout</a></li>


         </ul>
      </div>
      <!--/.navbar-collapse -->
   </div>
</div>




<!--=======================  MAP  =========================================-->
    
<div id="map"></div>



<!--===========================================================================-->
<!--                       r e c i p e   t a b    
<!-============================================================================-->

<a href="#"><img src="/graphics/tab.png"  class="handle"/></a>
<div id="tab">
    <div id="inner">
        <a href="#" class="x" style="color:black">x</a>
          <div id="innerinner">
            <div id="rest">
            <h3><div class="recipetitle"></div></h3>
            <div class="views"><h3>Welcome to Traveling Table!</h3><br>Whenever you click on a marker, you can view its recipe in this window. If you log in, you can also upvote and add your own recipes! <br><br>If you want to be particularly adventurous, check out our features menu for extras!<br><br>To see the top 5 recipes on the section of the map you're viewing, search 'top 5' in the search bar.</div><br>
            <div class="est_time"></div><br>
            <div class="recipeimage"></div><br>
            <div class="recipetype">Enjoy!</div><br>
            <div class="ingredients"></div><br>
            <div class="instructions"></div><br>
            <div class="extra_info"></div>
            <div class="vegcheck"></div>
            <div class="vegancheck"></div>
            <div class="gfcheck"><br></div>
            <div class="allergiescheck"></div><br>
            <div class="upvotes"></div>
            <div class="upvotebutton" hidden><a href="#" class="upvotebutton2">Upvote</a></div>
            <div class="voted">You upvoted this!</div>
          </div>
        </div>
    </div>
</div>





<!--===========================================================================-->
<!--                       s e a r c h   t a b    
<!-============================================================================-->

<div id="search_tab" hidden>
  <ul id="search_list">
    <div id="search_inner"><div class="white2">no results found</div></div>
  </ul>
</div>


<!--script>


$(function() {
  $("#search_input").click(function() {
    if ( $("#search_tab").hasClass("hidden")) {
         $("#search_tab").removeClass("hidden");
         $("#search_tab").slideDown("slow");              
    } else {
       if ( $("#search_tab").is(":hidden")) {
           $("#search_tab").slideDown("slow");
       } else {
          $("#search_tab").slideUp("slow");
        }
  }
})
})
</script-->

<script>
$(function() {
  $("#search_input").click(function() {
    if ( $("#search_tab").hasClass("hidden")) {
         $("#search_tab").removeClass("hidden");
         $("#search_tab").slideDown("fast");              
    } else {
       if ( $("#search_tab").is(":hidden")) {
           $("#search_tab").slideDown("fast");
       }
}})
})
</script>

<script>

$(document).click(function(evt){    
    if ($("#search_tab").hasClass("hidden")===false) {
      //console.log('its showing');
      //alert(evt.target.id);
        if(evt.target.id !== "search_input") {
            $("#search_tab").slideUp("fast");
            //alert('nope');
            return;
          //}
       }
        }
      });  

</script>



<!--===========================================================================-->
<!--                       e x t r a s   t a b    
<!-============================================================================-->


<script type="text/javascript">
$('.handle').click(function() {
  $( "#tab" ).toggle("fast");
});

$('.x').click(function() {
  $( "#tab" ).toggle("fast");
});
</script>

<script>

function lucky_click() {
  $.ajax({
    type: "POST",
    url: "/feelingLucky",
    success: function(data) {
      //console.log('success in lucky');
      latitude = data.marker_array[0];
      longitude = data.marker_array[1];
      markerID2 = data.marker_array[2];
      //console.log('markerid: '+markerID2);
      var panPoint = new google.maps.LatLng(latitude,longitude);
      map.panTo(panPoint);
      map.setZoom(7)
      var recipe_name;
      var recipe_type;
      var recipe_image;
      var vegetarian;
      var vegan;
      var gluten;
      var allergies;
      var upvotes;
      var ingredients;
      var steps;
      var est_time;
      var views;
      var extra_info;

        $.ajax({
              type: "POST",
              url: "/viewRecipe",
              data: '&markerID='+markerID2,
              success: function(data) {
                //console.log('breakpoint 2')
                recipe_name = data.recipe_name
                recipe_type = data.recipe_type
                recipe_image = data.recipe_image
                vegetarian = data.vegetarian
                vegan = data.vegan
                gluten = data.gluten
                allergies = data.allergies
                upvotes = data.upvotes
                ingredients = data.ingredients[0].split('~`~,');
                steps = data.instructions[0].split('~`~,');
                est_time = data.prep_time
                views = data.views
                extra_info = data.extra_info
                //console.log('stuff', views, ingredients, steps, est_time);
                 
          if (vegetarian===true) {
            vegetarian=' checked/> Vegetarian</br>';
          } else {
            vegetarian='/> Vegetarian</br>';
          }
          if (vegan===true) {
            vegan=' checked/> Vegan</br>';
          } else {
            vegan='/> Vegan</br>';
          }
          if (gluten===true) {
            gluten=' checked/> Gluten-Free</br>';
          } else {
            gluten='/> Gluten-Free</br>';
          }
          if (allergies===true) {
            allergies =' checked/> No Peanuts/Soy</br>';
          } else {
            allergies ='/> No Peanuts/Soy</br>';
          }
        },
          async: false
        });

//check if you can upvote or no, if not, itll replace it with a thing that says you voted luls no button nemorez
    $.ajax({
        type: "POST",
        url: "/Refresh",
        data: "&markerID="+markerID2,
        success: function(data) {
          //console.log('LOGGED in var below')
          //console.log(data.authenticated);
           if (data.authenticated) {
                $.ajax({
                        type: "POST",
                        url: "/canUpvote",
                        data: "&markerID="+markerID2,
                        success: function(data) {
                           //console.log(data.upvoted+" = upvoted or not");
                           if (data.upvoted) {
                            //$('.upvotebutton').html('You upvoted this!');
                            $('.voted').show();
                            $('.upvotebutton').hide();
                           } else {
                            //$('.upvotebutton').html('<a href="#" class="upvotebutton2">Upvote</a>');
                            $('.voted').hide();
                            $('.upvotebutton').show();
                           }
                         }
                       })
              }}});

      //console.log(ingredients);
      var ingredient_display=''
      for (var i=0; i<ingredients.length;i++) {
        ingredient_display=ingredient_display+'<li>'+ingredients[i]+'</li>'
      }

      var instruction_display=''
      for (var j=0; j<steps.length;j++) {
        instruction_display=instruction_display+'<li>'+steps[j]+'</li>'
      }




      $('.recipetitle').html('<div><strong>'+recipe_name+'</strong></div>');
      $('.recipeimage').html('<img id="image" src="'+recipe_image+'" style="width:20vw;height:auto" />');     
      $('.recipetype').html('<div><strong>Dish Type:</strong> '+recipe_type+'</div>'); 
      $('.upvotes').html('<div><strong>'+upvotes+' </strong>upvotes</div>') 
      $('.views').html('<div><strong>'+views+'</strong> views</div>');
      $('.instructions').html('<div><strong>Instructions: </strong><ol>'+instruction_display+'</ol></div>');
      $('.ingredients').html('<div><strong>Ingredients: </strong><ul>'+ingredient_display+'</ul></div>');
      $('.est_time').html('<div><strong>Estimated cook time:</strong>   '+est_time+' hours</div>');
      $('.vegcheck').html('<div class="reciperestrictions"><strong>Meets these dietary restrictions:</strong></div><input type="checkbox" onclick="return false"'+vegetarian);
      $('.vegancheck').html('<input type="checkbox" onclick="return false"'+vegan);
      $('.gfcheck').html('<input type="checkbox" onclick="return false" '+gluten);
      $('.allergiescheck').html('<input type="checkbox" onclick="return false" '+allergies);
// console.log(extra_info);
      if (extra_info!== '' && extra_info!== undefined) {
        $('.extra_info').html('<div><strong>Extra Information:</strong><br>'+extra_info+'<br></div>');

}







      var image = document.getElementById('image');
        image.onerror = function() {
        image.src = '/graphics/GlobalGobi.png';
      }


    }
  })
}


</script>


</body>
</html>